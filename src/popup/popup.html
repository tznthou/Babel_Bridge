<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Babel Bridge</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>🌉 Babel Bridge</h1>
        <p class="subtitle">AI 即時字幕與翻譯</p>
      </header>

      <main>
        <!-- API Key 設定區 -->
        <section id="api-key-section" class="section">
          <h2>API Key 設定</h2>

          <!-- Tab 切換 -->
          <div class="tabs">
            <button class="tab active" data-tab="openai">OpenAI</button>
            <button class="tab" data-tab="deepgram">Deepgram</button>
          </div>

          <!-- OpenAI Tab -->
          <div id="openai-panel" class="tab-panel active">
            <div class="input-group">
              <input
                type="password"
                id="openai-api-key-input"
                placeholder="sk-proj-..."
                autocomplete="off"
              />
              <button id="verify-openai-btn" class="btn btn-primary">驗證並儲存</button>
            </div>
            <p id="openai-api-key-status" class="status"></p>
            <div id="openai-key-info" class="key-info hidden">
              <p>✓ API Key 已設定</p>
              <p class="key-masked" id="openai-key-masked"></p>
              <p class="key-verified" id="openai-key-verified"></p>
              <button id="remove-openai-key" class="btn btn-small btn-danger">移除 API Key</button>
            </div>
          </div>

          <!-- Deepgram Tab -->
          <div id="deepgram-panel" class="tab-panel">
            <div class="input-group">
              <input
                type="password"
                id="deepgram-api-key-input"
                placeholder="輸入 Deepgram API Key"
                autocomplete="off"
              />
              <button id="verify-deepgram-btn" class="btn btn-primary">驗證並儲存</button>
            </div>
            <p id="deepgram-api-key-status" class="status"></p>
            <div id="deepgram-key-info" class="key-info hidden">
              <p>✓ API Key 已設定</p>
              <p class="key-masked" id="deepgram-key-masked"></p>
              <p class="key-verified" id="deepgram-key-verified"></p>
              <p class="key-meta">Project: <span id="deepgram-project-uuid"></span></p>
              <p class="key-meta">權限: <span id="deepgram-scopes"></span></p>
              <button id="remove-deepgram-key" class="btn btn-small btn-danger">移除 API Key</button>
            </div>

            <!-- Deepgram 模型與語言設定 -->
            <div id="deepgram-settings" class="settings-group">
              <h3>辨識設定</h3>

              <!-- 模型選擇 -->
              <div class="setting-item">
                <label for="deepgram-model">模型：</label>
                <select id="deepgram-model">
                  <option value="nova-2">Nova-2 (標準) - $0.0043/min</option>
                  <option value="nova-3">Nova-3 (進階) - $0.0077/min</option>
                </select>
              </div>

              <!-- 語言選擇 -->
              <div class="setting-item">
                <label for="deepgram-language">語言：</label>
                <select id="deepgram-language">
                  <option value="multi" data-nova3-only="true">🌐 自動偵測 (僅 Nova-3)</option>
                  <option value="en">🇺🇸 English</option>
                  <option value="en-US">🇺🇸 English (US)</option>
                  <option value="zh-TW" selected>🇹🇼 繁體中文</option>
                  <option value="zh">🇨🇳 简体中文</option>
                  <option value="ja">🇯🇵 日本語</option>
                  <option value="ko">🇰🇷 한국어</option>
                  <option value="es">🇪🇸 Español</option>
                  <option value="fr">🇫🇷 Français</option>
                  <option value="de">🇩🇪 Deutsch</option>
                </select>
              </div>

              <p id="deepgram-settings-hint" class="hint">
                提示：Nova-3 支援自動語言偵測，但費用較高 (+79%)
              </p>
            </div>
          </div>
        </section>

        <!-- 控制區 -->
        <section id="control-section" class="section">
          <h2>字幕控制</h2>
          <div class="toggle-group">
            <button id="enable-btn" class="btn btn-large btn-success">啟用字幕</button>
            <button id="disable-btn" class="btn btn-large btn-danger" disabled>停用字幕</button>
          </div>
          <p id="status-text" class="status">未啟用</p>
        </section>

        <!-- 成本統計區 -->
        <section id="cost-section" class="section">
          <h2>本月使用統計</h2>
          <div class="stats">
            <div class="stat-item">
              <span class="stat-label">Whisper:</span>
              <span id="whisper-cost" class="stat-value">$0.00</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">GPT:</span>
              <span id="gpt-cost" class="stat-value">$0.00</span>
            </div>
            <div class="stat-item stat-total">
              <span class="stat-label">總計:</span>
              <span id="total-cost" class="stat-value">$0.00</span>
            </div>
          </div>
          <button id="refresh-stats-btn" class="btn btn-small">重新整理</button>
        </section>
      </main>

      <footer>
        <p class="version">v0.1.0 - Phase 1 (基礎辨識)</p>
      </footer>
    </div>

    <script type="module" src="popup.js"></script>
  </body>
</html>
